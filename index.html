<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="/manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>구역별 스프레드시트 이동</title>
</head>
<body>
    <div class="download-section">
        <h3>앱 다운로드</h3>
        <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.docs.editors.sheets" target="_blank" aria-label="Google Play Store에서 다운로드">
            <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg" alt="">
        </a>
        <a href="https://apps.apple.com/app/google-sheets/id842849113" target="_blank" aria-label="App Store에서 다운로드">
            <img src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg" alt="">
        </a>
    </div>

    <h2>구역별 스프레드시트 이동</h2>
    <div id="links"></div>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(reg => console.log('Service Worker Registered!', reg))
                .catch(err => console.log('Service Worker registration failed: ', err));
        }

        const sheetUrl = "https://docs.google.com/spreadsheets/d/1yD3sPYsU3U-aBpLrQ62IFQK5WCb1Ut1ACNTnQEnQZOE/edit#gid=0";
        const areas = ["11구역", "12구역", /* ... */];
        const linksDiv = document.getElementById("links");

        areas.forEach(area => {
            const div = document.createElement("div");
            div.classList.add("link-container");
            div.innerHTML = `<a class="button" href="${sheetUrl.replace("gid=0", `gid=${getGid(area)}`)}" target="_blank">${area} 이동</a>`;
            linksDiv.appendChild(div);
        });

        function getGid(area) {
            const gids = { /* ... */ };
            if (gids[area]) {
                return gids[area];
            } else {
                alert(`${area}에 해당하는 시트를 찾을 수 없습니다.`);
                return;
            }
        }
    </script>
</body>
</html>
